var pmcPiano;!function(){"use strict";var e={515:function(e,t,n){var a,o=this&&this.__assign||function(){return o=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},o.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.pmcPianoNewsletterForm=void 0,n(510);var i="";t.pmcPianoNewsletterForm={initialized:!1,canDebug:window.pmcPianoData.canDebug,targetElements:{paywall:".pmc-paywall",paywallFade:"a-article-nl-fade",overlay:"div[id=piano-paywall] .tp-container-inner"},postMessageTrustedOrigin:{qa:"https://sandbox.tinypass.com",procution:"https://buy.tinypass.com"},signupURLs:{billboard:"https://cloud.email.billboard.com/signup/",sourcingjournal:"https://cloud.email.sourcingjournal.com/signup/"},modal:!0,emailInputFocused:!1,get:function(e){return document.querySelector(e)},setupFormData:function(e){for(var t=o({__contextName:"FormPost",__executionContext:"Post"},e.data.formData),n=new FormData,a=0,i=Object.entries(t);a<i.length;a++){var r=i[a],s=r[0],l=r[1];n.append(s,l)}return n},signupNewsLetter:function(e){var t=r.signupURLs[i];t?fetch(t,{method:"POST",mode:"no-cors",body:e}).then((function(e){console.log("PMC: Piano: POST request to ExactTarget successful:",e)})).catch((function(e){console.log("PMC: Piano: Error sending formData to ExtactTarget:",e)})):r.canDebug&&console.log("PMC: Piano: Invaild brand for newsletter form submission")},setModal:function(){var e=r.get(r.targetElements.paywall),t=r.get("".concat(r.targetElements.overlay," iframe"));e&&t?(e.classList.add(r.targetElements.paywallFade),window.addEventListener("scroll",(function(){var t=r.get(r.targetElements.overlay),n=e.getBoundingClientRect().top+window.scrollY,a=function(){var e,t,n,a=(null===(e=r.get("header"))||void 0===e?void 0:e.offsetHeight)||0,o=null===(t=r.get(".pmc-paywall > .jw-state-playing"))||void 0===t?void 0:t.offsetHeight,i=null===(n=r.get(".live-event-banner > .banner-regular"))||void 0===n?void 0:n.offsetHeight;if(window.innerWidth<768){if(o>0)return a+o;if(i>0)return a+i}return a}();t.style.top="0",t.style.zIndex="2",t.style.transition="top 0.1s ease 0s";var o=(e.getBoundingClientRect().top<=a?Math.min(Math.max(0,window.scrollY+a-n),e.clientHeight-t.clientHeight):0)+(r.emailInputFocused?-150:0);t.style.position="absolute",t.style.top="".concat(o,"px")}))):setTimeout(r.setModal)},registerPostMessageListener:function(){window.addEventListener("message",(function(e){if(Object.values(r.postMessageTrustedOrigin).includes(e.origin)&&"string"==typeof e.type)if("piano_template_newsletter_close_button_clicked"===e.data.type){var t=r.get(r.targetElements.paywall);null==t||t.classList.remove(r.targetElements.paywallFade);var n=r.get(r.targetElements.overlay);null==n||n.classList.add("lrv-a-hidden")}else"piano_template_newsletter_email_input"===e.data.type?(r.emailInputFocused=e.data.focused,window.dispatchEvent(new Event("scroll",{bubbles:!0}))):"piano_template_newsletter_submit_button_clicked"===e.data.type?(i=e.data.brand,a=r.setupFormData(e),r.signupNewsLetter(a)):"piano_regwall_register_button_clicked"===e.data.type&&(i=e.data.brand,a=r.setupFormData(e),console.log("Data Stored for Registration",a))}))},registrationSuccess:function(e){var t=this;if("string"==typeof e.data){var n=void 0;try{n=JSON.parse(e.data)}catch(e){return t.canDebug&&console.warn("PMC: Piano: registration",e),console.warn("PMC: Piano: newsletter registration",e),!1}n.sender&&n.sender.startsWith("piano-id")&&"registrationSuccess"===n.event&&(t.canDebug&&console.log("PMC: Piano: newsletter registrationSuccess",e),console.log("PMC: Piano: newsletter registrationSuccess",e),a.set("EmailAddress",n.params.user.email),setTimeout(t.signupNewsLetter(a),1e3))}return!0},initialize:function(){!0!==r.initialized?(console.log("PMC: Piano: Initializing PMC Piano Newsletter Form"),!0===r.modal&&r.setModal(),r.registerPostMessageListener(),window.addEventListener("message",r.registrationSuccess.bind(r)),r.initialized=!0):r.canDebug&&console.log("PMC: Piano: PMC Piano Newsletter Form is already initialized")}};var r=t.pmcPianoNewsletterForm;e.exports=t.pmcPianoNewsletterForm},510:function(e,t,n){n.r(t)}},t={};function n(a){var o=t[a];if(void 0!==o)return o.exports;var i=t[a]={exports:{}};return e[a].call(i.exports,i,i.exports,n),i.exports}n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a=n(515);(pmcPiano=void 0===pmcPiano?{}:pmcPiano).newsletterForm=a}();